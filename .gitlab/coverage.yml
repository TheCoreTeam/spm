#
# Rule to gather the coverages from the different branches
#
---
coverage:
  stage: analyse
  artifacts:
    name: spm_coverage
    expire_in: 180 minutes
    paths:
      - spm.lcov
      - spm-*.lcov
      - spm-gcov.log
  script:
    - export INPUT_FILES=""
    - for name in $( ls -1 spm-*.lcov );
      do
        export INPUT_FILES="$INPUT_FILES -a $name";
      done
    - lcov $INPUT_FILES -o spm.lcov  | tee -a spm-gcov.log
    - lcov --summary spm.lcov | tee -a spm-gcov.log
